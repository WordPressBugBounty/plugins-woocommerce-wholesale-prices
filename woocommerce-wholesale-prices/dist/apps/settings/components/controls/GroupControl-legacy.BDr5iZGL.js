System.register(["../../../../common/preload-helper-legacy.CQ_hQ112.js","../../../../common/settings-store-legacy.JasuUry0.js","../../index-legacy.DSRF5j6X.js","../../../../common/DataTableControl.vue_vue_type_script_setup_true_lang-legacy.Xv3Hxi3o.js","../../../../common/index-legacy.R-I-07Yu.js","../../../../common/GroupControl.vue_vue_type_style_index_0_scoped_ac0e52be_lang-legacy.BhDSN6Mf.js","../../../../common/_plugin-vue_export-helper-legacy.BVIICed7.js","../../../../common/GroupEditFields.vue_vue_type_script_setup_true_lang-legacy.Cu1QC-oy.js","../../../../common/index-legacy.Dl3nZfEd.js","../../../../common/FormItemContext-legacy.DA5wtcI0.js","../../../../common/createContext-legacy.CMiT7FS1.js","../../../../common/statusUtils-legacy.BrKJx4rr.js","../../../../common/motion-legacy.D5Gaa4S_.js","../../../../common/SearchOutlined-legacy.BqL7q6Ym.js","../../../../common/compact-item-legacy.BvKH-EuT.js","../../../../common/index-legacy.DsJikat_.js","../../../../common/isPlainObject-legacy.BufiCFN3.js","../../../../common/index-legacy.BixUd7Mt.js","../../../../common/index-legacy.b39YZjRW.js","../../../../common/KeyCode-legacy.Cey0FNFJ.js","../../../../common/pickAttrs-legacy.BYQKBFnK.js","../../../../common/slide-legacy.CJWbujvw.js","../../../../common/isMobile-legacy.B1xuVHMd.js","../../../../common/useMergedState-legacy.DxUcROHi.js","../../../../common/useState-legacy.DzBuJFQm.js","../../../../common/DownOutlined-legacy.BJr4iZ_d.js","../../../../common/index-legacy.Cyp0n6rB.js","../../../../common/index-legacy.B2v9t8LN.js","../../../../common/index-legacy.SsUFegKa.js","../../../../common/warning-legacy.BXrMpzCz.js","../../../../common/index-legacy.CplgkQ9T.js","../../../../common/index-legacy.zfWQAWJx.js","../../../../common/ActionButton-legacy.BIrgQnDG.js","../../../../common/EditOutlined-legacy.C3mKFC3P.js","../../../../common/DeleteOutlined-legacy.BhHXlIuc.js","../../../../common/index-legacy.CgXph35b.js","../../../../common/index-legacy.BpOtpZ8B.js","../../../../common/index-legacy.CxEVGbEt.js","../../../../common/Checkbox-legacy.ZX98kczT.js","../../../../common/index-legacy.BDP2XoPl.js","../../../../common/debounce-legacy.C6yFXkXA.js"],function(e,l){"use strict";var n,a,o,t,i,u,d,c,s,m,v,r,y,p,f,g,j,_,b,x,h,k,D,C,O,A,S;return{setters:[e=>{n=e.d,a=e.ar,o=e.bm,t=e.A,i=e.r,u=e.bn,d=e.bo,c=e.aa,s=e.by,m=e.bq,v=e.bu,r=e.bz,y=e.a9,p=e.h,f=e.bC,g=e.bp,j=e.a4,_=e.bs,b=e.br,x=e.bw},e=>{h=e.u},e=>{k=e.l,D=e._,C=e.s},e=>{O=e._},e=>{A=e.B},null,e=>{S=e._},null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],execute:function(){const l=["id"],w={class:"data-table-buttons"},F={class:"data-table"};e("default",S(n({__name:"GroupControl",props:{params:{type:Object,required:!0},conditionalValues:{type:Object,required:!1,default:()=>({})}},emits:["input","fieldData","selectedCondition","conditionalData","selectedDependent","fieldUpdatedData","fieldUpdatedPopupData"],setup(e,{emit:n}){var S,q;const U=e,{params:E}=a(U),G=h(),{selectedConditionKey:B,selectedConditionValue:I,groupData:K}=o(G),M=n,z=E.value,J=z.classes,P=z.id,V=t(z.fields),H=i({fields:V.value}),L=t(z.table.data),N=z.group_action,T=t(null===(S=null===(q=z.table)||void 0===q?void 0:q.inline_edit)||void 0===S||S),Q=t(!1),R=t([]),W=t([]);if(void 0!==K.value&&Object.keys(K.value).length>0&&void 0!==K.value[P]&&(L.value=K.value[P]),H.fields)for(const[l,a]of Object.entries(H.fields)){const e=a;R.value[e.id]=e.default}const X=e=>{Object.entries(e).forEach(([e,l])=>{R.value[e]=l})};void 0!==V.value&&null!==V.value&&(H.fields=V.value.filter(e=>void 0===e.hide||null===e.hide||!e.hide));const Y=e=>{let l="",n="";for(const[a,o]of Object.entries(e))l=a,n=o;H.fields=V.value.filter(e=>{if(void 0!==e.condition&&null!==e.condition){const a=e.condition.find(e=>e.key===l);return"yes"===a.value&&"yes"===n||"no"===a.value&&"no"===n}return!0}),W.value[l]=n},Z=e=>{Object.assign(L.value.filter(l=>e.key===l.key)[0],e),K.value[P]=L.value},$=e=>{L.value=L.value.filter(l=>l.key!==e),K.value[P]=L.value},ee=e=>{let l="",n="";for(const[a,o]of Object.entries(e))l=a,n=o;H.fields=V.value.filter(e=>{const a=V.value.find(l=>l.id===e.id);if(a){if(void 0!==a.condition&&null!==a.condition){const o=a.condition.find(e=>e.key===l);return!(void 0===o||o.key!==l||(Array.isArray(o.value)||o.value!==n)&&(!Array.isArray(o.value)||!o.value.includes(n))||(void 0!==R.value[a.id]&&null!==R.value[a.id]&&(e.default=R.value[a.id]),void 0!==a.dependent_option&&null!==a.dependent_option&&(e.default=a.dependent_default),0))}return void 0!==R.value[a.id]&&null!==R.value[a.id]&&(e.default=R.value[a.id]),void 0!==a.dependent_option&&null!==a.dependent_option&&(e.default=a.dependent_default),!0}return!1})},le=e=>{H.fields=V.value.filter(e=>{const l=V.value.find(l=>l.id===e.id);return!(!l||void 0!==l.hide&&null!==l.hide&&l.hide||(void 0!==R.value[l.id]&&null!==R.value[l.id]&&(e.default=R.value[l.id]),void 0!==l.dependent_option&&null!==l.dependent_option&&(e.default=l.dependent_default),0))})},ne=async()=>{Q.value=!0;const e=[{key:"action",value:N}],l={};let n=0;if(L.value.length>0){let e=L.value.map(e=>e.key);n=Math.max(...e)+1}l.key=n;for(const[o,t]of Object.entries(R.value)){let n=t;"object"==typeof t&&null!==t&&(n=JSON.stringify(t)),e.push({key:o,value:n});let a=t;const i=V.value.find(e=>e.id===o);void 0!==i&&void 0!==i.prefix&&(a=i.prefix+t),l[o]=a}R.value=[];try{"success"===await C(e)&&(L.value.push(l),K.value[P]=L.value,B.value="",I.value="",T.value||M("fieldUpdatedData",l)),Q.value=!1}catch(a){console.error(a)}finally{Q.value=!1}};return(e,n)=>(u(),d("div",{id:y(P),class:x(y(J))},[(u(!0),d(c,null,s(H.fields,(e,l)=>(u(),d("div",{key:l},[(u(),m(f,null,{fallback:v(()=>[p(D)]),default:v(()=>[(u(),m(r(y(k)(e.type)),{params:e,"conditional-values":W.value,onFieldData:X,onConditionalData:Y,onSelectedCondition:ee,onSelectedDependent:le},null,40,["params","conditional-values"]))]),_:2},1024))]))),128)),g("div",w,[""!==y(z).button_label?(u(),m(y(A),{key:0,type:"primary",class:"save-group-btn",loading:Q.value,onClick:ne},{default:v(()=>[j(_(y(z).button_label),1)]),_:1},8,["loading"])):b("",!0)]),g("div",F,[p(O,{params:y(z).table,data:L.value,"edit-fields":V.value,onFieldUpdatedData:Z,onFieldDeletedData:$},null,8,["params","data","edit-fields"])])],10,l))}}),[["__scopeId","data-v-ac0e52be"]]))}}});
